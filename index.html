<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Simulasi Trading Ultimate</title>
    <style>
        /* --- STYLE DASAR --- */
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100vw;
            margin: 0;
            overflow: hidden;
            touch-action: none; /* Mencegah browser zoom/scroll default */
            user-select: none;
        }

        /* --- KONTROL TOMBOL (Hanya muncul saat mouse hover di atas atau disentuh) --- */
        #controls {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 10px;
            z-index: 2000;
            display: flex;
            justify-content: center;
            gap: 10px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            transition: transform 0.3s ease;
        }
        
        /* Sembunyikan kontrol jika mode play aktif (opsional, biar bersih total) */
        body.play-mode #controls {
            transform: translateY(-100%); /* Geser ke atas layar */
        }
        
        /* Area pemicu untuk memunculkan menu lagi saat mode play */
        #trigger-menu {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 20px;
            z-index: 1999;
        }
        #trigger-menu:hover ~ #controls, #controls:hover {
            transform: translateY(0);
        }

        button {
            padding: 10px 15px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        .btn-edit { background-color: #FFC107; color: black; }
        .btn-lock { background-color: #28a745; }
        .btn-reset { background-color: #dc3545; }

        /* --- WADAH HP --- */
        #phone-container {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: #000;
            overflow: hidden;
        }

        /* Mode Edit: Tampilkan bingkai biar tahu batas HP */
        body:not(.play-mode) #phone-container {
            border: 2px dashed #FFC107;
            box-sizing: border-box;
        }

        /* --- LAYAR GAMBAR --- */
        .screen {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: none;
            background-size: 100% 100%; /* Memaksa gambar full screen */
            background-position: center;
            background-repeat: no-repeat;
        }

        .screen.active { display: block; }

        /* Pesan error gambar */
        .screen::after {
            content: "‚ö†Ô∏è " attr(data-img) " ?\A Cek file.";
            white-space: pre-wrap;
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: #ff6b6b;
            font-size: 14px;
            z-index: -1;
        }

        /* --- AREA INTERAKTIF (KOTAK MERAH) --- */
        .click-area, .focus-area, .scroll-area {
            position: absolute;
            box-sizing: border-box;
            z-index: 10;
            touch-action: none;
        }

        /* --- TAMPILAN MODE EDIT --- */
        body:not(.play-mode) .click-area {
            cursor: move;
            border: 2px dashed #FFC107; /* Kuning putus-putus */
            background-color: rgba(255, 193, 7, 0.2);
        }
        
        body:not(.play-mode) .scroll-area {
            cursor: move;
            border: 2px dashed #00BCD4; /* Biru muda untuk scroll */
            background-color: rgba(0, 188, 212, 0.2);
        }
        
        body:not(.play-mode) .scroll-area::after {
            content: "AREA SCROLL";
            font-size: 10px; color: #00BCD4;
            position: absolute; top: 50%; left: 50%; 
            transform: translate(-50%, -50%);
            font-weight: bold;
        }

        /* --- TAMPILAN MODE PLAY (BERSIH) --- */
        body.play-mode .click-area, 
        body.play-mode .focus-area,
        body.play-mode .scroll-area {
            border: none;
            background-color: transparent; /* Hilang total */
            cursor: pointer;
            animation: none;
        }

        /* Visual feedback saat ditekan (hanya di mode play) */
        body.play-mode .click-area:active {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Resizer (Hanya muncul di Mode Edit) */
        .resizer {
            width: 30px; height: 30px;
            background: #007bff;
            border: 2px solid white;
            border-radius: 50%;
            position: absolute;
            right: -10px; bottom: -10px;
            cursor: se-resize;
            display: none;
            z-index: 20;
        }
        body:not(.play-mode) .resizer { display: block; }

        /* Layar Selesai */
        #finish-screen {
            background-color: #111;
            color: white;
            display: none; 
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            height: 100%; width: 100%;
        }
    </style>
</head>
<body class="">

    <!-- Area pemicu menu saat disembunyikan -->
    <div id="trigger-menu"></div>

    <!-- KONTROL -->
    <div id="controls">
        <button id="btn-mode" class="btn-edit" onclick="toggleMode()">üîì Buka Gembok (Edit)</button>
        <button class="btn-fullscreen" onclick="toggleFullScreen()">‚õ∂ Full Screen</button>
        <button class="btn-reset" onclick="resetPositions()">‚ö†Ô∏è Reset Posisi</button>
    </div>

    <!-- WADAH HP -->
    <div id="phone-container">
        
        <!-- 1. Telegram -->
        <div class="screen active" id="screen-1" style="background-image: url('1.jpg');" data-img="1.jpg">
            <div id="box-1" class="click-area" style="top: 73%; left: 26%; width: 18%; height: 9%;" onclick="next(2)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 2. Group -->
        <div class="screen" id="screen-2" style="background-image: url('2.jpg');" data-img="2.jpg">
            <div id="box-2" class="click-area" style="top: 17%; left: 0%; width: 100%; height: 10%;" onclick="next(3)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 3. Pin -->
        <div class="screen" id="screen-3" style="background-image: url('3.jpg');" data-img="3.jpg">
            <div id="box-3" class="click-area" style="top: 0%; left: 30%; width: 70%; height: 8%;" onclick="next(4)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 4. Kartu Sinyal -->
        <div class="screen" id="screen-4" style="background-image: url('4.jpg');" data-img="4.jpg">
            <div id="box-4" class="click-area" style="top: 50%; left: 5%; width: 90%; height: 25%;" onclick="next(5)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 5. Home -->
        <div class="screen" id="screen-5" style="background-image: url('5.jpg');" data-img="5.jpg">
            <div id="box-5" class="click-area" style="top: 0%; left: 0%; width: 15%; height: 8%;" onclick="next(6)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 6. App Opalp -->
        <div class="screen" id="screen-6" style="background-image: url('6.jpg');" data-img="6.jpg">
            <div id="box-6" class="click-area" style="top: 60%; left: 26%; width: 18%; height: 9%;" onclick="next(7)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 7. Kontrak -->
        <div class="screen" id="screen-7" style="background-image: url('7.jpg');" data-img="7.jpg">
            <div id="box-7" class="click-area" style="bottom: 0%; left: 25%; width: 25%; height: 8%;" onclick="next(8)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 8. SCROLL AREA (SPESIAL) -->
        <div class="screen" id="screen-8" style="background-image: url('8.jpg');" data-img="8.jpg">
            <!-- Ini bukan click-area biasa, tapi scroll-area -->
            <div id="box-8" class="scroll-area" style="top: 20%; left: 10%; width: 80%; height: 60%;">
                <div class="resizer"></div>
            </div>
            <!-- Petunjuk visual saat mode edit -->
            <div style="position:absolute; bottom:10%; width:100%; text-align:center; color:#00BCD4; font-size:12px; pointer-events:none; display:none;" id="scroll-hint">
                [MODE EDIT] Posisikan kotak biru ini di area yang ingin di-scroll
            </div>
        </div>

        <!-- 9. Periode -->
        <div class="screen" id="screen-9" style="background-image: url('9.jpg');" data-img="9.jpg">
            <div id="box-9" class="click-area" style="top: 35%; right: 5%; width: 40%; height: 6%;" onclick="next(10)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 10. 1% & Beli/Jual -->
        <div class="screen" id="screen-10" style="background-image: url('10.jpg');" data-img="10.jpg">
            <div id="box-10a" class="click-area" style="top: 45%; left: 5%; width: 15%; height: 5%;" onclick="step10Part2()">
                <div class="resizer"></div>
            </div>
            <div id="box-10b" class="click-area" style="display:none; top: 55%; left: 5%; width: 43%; height: 7%;" onclick="next(11)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 11. Konfirmasi -->
        <div class="screen" id="screen-11" style="background-image: url('11.jpg');" data-img="11.jpg">
            <div id="box-11" class="click-area" style="top: 55%; right: 10%; width: 35%; height: 6%;" onclick="next(12)">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- 12. Pesanan Terbuka -->
        <div class="screen" id="screen-12" style="background-image: url('12.jpg');" data-img="12.jpg">
            <div id="box-12-finish" class="click-area" style="bottom: 10%; left: 25%; width: 50%; height: 8%;" onclick="finish()">
                <div class="resizer"></div>
            </div>
        </div>

        <!-- Finish -->
        <div id="finish-screen">
            <h1 style="color: #28a745;">TRANSAKSI SELESAI!</h1>
            <p style="color:#aaa;">Simulasi berhasil.</p>
            <button class="btn-reset" onclick="location.reload()" style="margin-top:20px;">Ulangi</button>
        </div>
        
    </div>

    <script>
        let isPlayMode = false; // False = Mode Edit, True = Mode Main (Clean)
        const container = document.getElementById('phone-container');

        window.onload = function() {
            loadPositions();
            initDragAndResizeListeners();
            initScrollLogic();
        };

        // --- MODE TOGGLE ---
        function toggleMode() {
            isPlayMode = !isPlayMode;
            const btn = document.getElementById('btn-mode');
            const body = document.body;
            
            if (isPlayMode) {
                // Masuk ke Mode Main (Bersih)
                body.classList.add('play-mode');
                btn.innerHTML = "üîí Kunci & Mainkan";
                btn.className = "btn-lock";
                // Pastikan Step 10 di-reset
                document.getElementById('box-10a').style.display = 'block';
                document.getElementById('box-10b').style.display = 'none';
            } else {
                // Masuk ke Mode Edit
                body.classList.remove('play-mode');
                btn.innerHTML = "üîì Buka Gembok (Edit)";
                btn.className = "btn-edit";
                savePositions(); // Simpan posisi saat keluar dari mode edit
                // Tampilkan semua elemen Step 10 biar bisa diedit
                document.getElementById('box-10a').style.display = 'block';
                document.getElementById('box-10b').style.display = 'block';
            }
        }

        // --- NAVIGASI ---
        function next(step) {
            if (!isPlayMode) return; // Jangan pindah layar kalau lagi ngedit
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            const target = document.getElementById('screen-' + step);
            if(target) target.classList.add('active');
        }

        function step10Part2() {
            if (!isPlayMode) return;
            document.getElementById('box-10a').style.display = 'none';
            document.getElementById('box-10b').style.display = 'block';
        }

        function finish() {
            if (!isPlayMode) return;
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('finish-screen').style.display = 'flex';
        }

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e => console.log(e));
            } else {
                if (document.exitFullscreen) document.exitFullscreen();
            }
        }

        // --- LOGIKA SCROLL (KHUSUS STEP 8) ---
        function initScrollLogic() {
            const scrollBox = document.getElementById('box-8');
            let startY = 0;

            // Touch (HP)
            scrollBox.addEventListener('touchstart', (e) => {
                if (!isPlayMode) return;
                startY = e.touches[0].clientY;
            }, {passive: true});

            scrollBox.addEventListener('touchend', (e) => {
                if (!isPlayMode) return;
                const endY = e.changedTouches[0].clientY;
                const diff = startY - endY;
                // Jika gerakan usap ke atas lebih dari 30px
                if (diff > 30) {
                    next(9); // Pindah ke layar 9
                }
            }, {passive: true});

            // Mouse (Laptop) - Menggunakan Wheel atau Drag Up
            scrollBox.addEventListener('wheel', (e) => {
                if (!isPlayMode) return;
                if (e.deltaY > 0) { // Scroll ke bawah
                    next(9);
                }
            });
            
            // Mouse Drag Simulation
            scrollBox.addEventListener('mousedown', (e) => {
                if (!isPlayMode) return;
                startY = e.clientY;
                
                const onMouseUp = (mu) => {
                    const endY = mu.clientY;
                    if (startY - endY > 30) next(9);
                    document.removeEventListener('mouseup', onMouseUp);
                };
                document.addEventListener('mouseup', onMouseUp);
            });
        }


        // --- DRAG & RESIZE (UNTUK EDIT) ---
        function getCoords(e) {
            return (e.touches && e.touches[0]) ? { x: e.touches[0].clientX, y: e.touches[0].clientY } : { x: e.clientX, y: e.clientY };
        }

        function initDragAndResizeListeners() {
            const boxes = document.querySelectorAll('.click-area, .scroll-area');
            boxes.forEach(box => {
                const resizer = box.querySelector('.resizer');

                const startResize = (e) => {
                    if (isPlayMode) return;
                    e.stopPropagation();
                    const startCoords = getCoords(e);
                    const startW = box.offsetWidth;
                    const startH = box.offsetHeight;
                    const cW = container.offsetWidth;
                    const cH = container.offsetHeight;

                    const onMove = (mv) => {
                        const curr = getCoords(mv);
                        box.style.width = ((startW + (curr.x - startCoords.x)) / cW * 100) + '%';
                        box.style.height = ((startH + (curr.y - startCoords.y)) / cH * 100) + '%';
                    };
                    const onEnd = () => removeLs(onMove, onEnd);
                    addLs(onMove, onEnd);
                };

                const startDrag = (e) => {
                    if (isPlayMode || e.target.classList.contains('resizer')) return;
                    if(e.type === 'touchstart') e.preventDefault();
                    const startCoords = getCoords(e);
                    const rect = box.getBoundingClientRect();
                    const cRect = container.getBoundingClientRect();
                    const startL = rect.left - cRect.left;
                    const startT = rect.top - cRect.top;

                    const onMove = (mv) => {
                        if(mv.type === 'touchmove') mv.preventDefault();
                        const curr = getCoords(mv);
                        box.style.left = ((startL + (curr.x - startCoords.x)) / container.offsetWidth * 100) + '%';
                        box.style.top = ((startT + (curr.y - startCoords.y)) / container.offsetHeight * 100) + '%';
                    };
                    const onEnd = () => removeLs(onMove, onEnd);
                    addLs(onMove, onEnd);
                };

                if(resizer) {
                    resizer.addEventListener('mousedown', startResize);
                    resizer.addEventListener('touchstart', startResize, {passive: false});
                }
                box.addEventListener('mousedown', startDrag);
                box.addEventListener('touchstart', startDrag, {passive: false});
            });
        }

        function addLs(mv, end) {
            document.addEventListener('mousemove', mv);
            document.addEventListener('mouseup', end);
            document.addEventListener('touchmove', mv, {passive: false});
            document.addEventListener('touchend', end);
        }
        function removeLs(mv, end) {
            document.removeEventListener('mousemove', mv);
            document.removeEventListener('mouseup', end);
            document.removeEventListener('touchmove', mv);
            document.removeEventListener('touchend', end);
        }

        // --- STORAGE ---
        function savePositions() {
            const pos = {};
            document.querySelectorAll('.click-area, .scroll-area').forEach(b => {
                if(b.id) pos[b.id] = {t: b.style.top, l: b.style.left, w: b.style.width, h: b.style.height};
            });
            localStorage.setItem('simulasi_pos_final', JSON.stringify(pos));
        }
        function loadPositions() {
            const saved = localStorage.getItem('simulasi_pos_final');
            if(saved) {
                try {
                    const pos = JSON.parse(saved);
                    for(let id in pos) {
                        const b = document.getElementById(id);
                        if(b) { b.style.top=pos[id].t; b.style.left=pos[id].l; b.style.width=pos[id].w; b.style.height=pos[id].h; }
                    }
                } catch(e){}
            }
        }
        function resetPositions() {
            if(confirm("Reset semua posisi kotak?")) {
                localStorage.removeItem('simulasi_pos_final');
                location.reload();
            }
        }
    </script>
</body>
</html>


